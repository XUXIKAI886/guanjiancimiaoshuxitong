# 产品优化助手

基于 AI 技术的智能产品关键词优化和描述生成系统,专为外卖、电商等行业设计。

## 项目简介

产品优化助手是一个强大的 AI 驱动工具,可以帮助您快速优化产品关键词和生成产品描述。系统支持批量处理,并提供 Excel 和 JPG 图片两种导出格式。

### 核心功能

- **关键词优化**: 批量优化产品关键词,添加表情符号和四字卖点
- **产品描述生成**: 根据产品名称自动生成吸引人的描述文案
- **Excel 文件上传**: 支持上传 Excel 文件,自动提取商品名称列
- **智能分批处理**: 大批量数据自动分批处理,无限制处理能力
- **双列对比**: 清晰展示优化前后的对比效果
- **多格式导出**: 支持导出为 Excel 表格和 JPG 图片
- **信息侧边栏**: 显示服务说明文案,支持一键复制

## 技术栈

- **框架**: Next.js 15 (App Router)
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **图标**: Lucide React
- **Excel 导出**: xlsx
- **图片导出**: 原生 Canvas API
- **AI 模型**: Gemini 2.5 Flash Lite

## 安装指南

### 环境要求

- Node.js 18.0 或更高版本
- npm 或 yarn 包管理器

### 安装步骤

1. 克隆项目

```bash
git clone <repository-url>
cd product-optimizer
```

2. 安装依赖

```bash
npm install
```

3. 配置环境变量

创建 `.env.local` 文件并填入配置:

```env
NEXT_PUBLIC_API_BASE_URL=https://jeniya.top/v1/chat/completions
NEXT_PUBLIC_API_MODEL=gemini-2.5-flash-lite
NEXT_PUBLIC_API_KEY=your-api-key-here
```

4. 启动开发服务器

```bash
npm run dev
```

5. 打开浏览器访问 [http://localhost:3000](http://localhost:3000)

## 使用说明

### Excel 文件上传(推荐)

系统支持直接上传 Excel 文件,自动提取商品名称进行批量处理:

1. 选择"关键词优化"或"产品描述生成"标签页
2. 点击"上传 Excel"按钮
3. 选择您的 Excel 文件(.xls 或 .xlsx)
4. 系统自动读取第四列"商品名称"的数据
5. 提取完成后自动填充到输入框
6. 点击"开始优化"或"开始生成"
7. 可导出为 Excel 表格或 JPG 图片

**Excel 格式要求**:
- 第一行为表头(会自动跳过)
- 商品名称必须在第四列
- 支持 .xls 和 .xlsx 格式

### 关键词优化(手动输入)

1. 选择"关键词优化"标签页
2. 点击"手动输入"按钮
3. 在输入框中输入产品关键词,每行一个
4. 支持套餐格式,用 `+` 连接多个产品(例如: 卤鸭板肠(小份)+卤菜(小份))
5. 点击"开始优化"按钮
6. 查看优化结果,系统会添加表情符号和四字卖点
7. 可导出为 Excel 表格或 JPG 图片

**输入示例:**
```
卤鸭板肠(小份)
柠檬茶(大杯)
卤鸭板肠(小份)+卤菜(小份)
```

**输出示例:**
```
卤鸭板肠(小份)【🍗卤香四溢】
柠檬茶(大杯)【🍹清爽解腻】
卤鸭板肠(小份)+卤菜(小份)【🍱组合丰富】
```

### 产品描述生成

1. 选择"产品描述生成"标签页
2. 在输入框中输入产品名称,每行一个
3. 点击"开始生成"按钮
4. 查看生成的产品描述
5. 可导出为 Excel 表格或 JPG 图片

**输入示例:**
```
麻辣小龙虾
招牌烤鱼
椒盐排骨
```

## 项目结构

```
product-optimizer/
├── app/                    # Next.js App Router 页面
│   ├── page.tsx           # 主页面
│   ├── layout.tsx         # 布局组件
│   └── globals.css        # 全局样式
├── components/            # React 组件
│   └── ProductOptimizer.tsx  # 优化器组件
├── lib/                   # 核心功能库
│   ├── api.ts            # AI API 调用
│   └── prompts.ts        # 提示词配置
├── utils/                 # 工具函数
│   └── export.ts         # 导出功能
├── types/                 # TypeScript 类型定义
│   └── index.ts          # 类型定义
└── public/               # 静态资源
```

## API 配置说明

系统使用 OpenAI 兼容的 API 接口,默认配置如下:

- **Base URL**: https://jeniya.top/v1/chat/completions
- **模型**: gemini-2.5-flash-lite
- **API Key**: 需要在 `.env.local` 中配置

如需更换其他 AI 服务商,只需修改环境变量即可。

## 关键算法说明

### 智能分批处理策略

系统采用智能分批处理策略,根据数据量自动选择最优处理方式:

#### 小批量模式 (≤阈值)
- **关键词优化**: ≤80 条
- **产品描述**: ≤50 条
- **处理方式**: 一次性提交,速度最快

#### 大批量模式 (>阈值)
- **自动分批**: 超过阈值自动启动分批处理
- **批次大小**: 关键词 80条/批,描述 50条/批
- **批次延迟**: 1秒间隔,避免 API 限流
- **容错机制**: 单批次失败不影响其他批次
- **无限制**: 理论上可处理任意数量数据

#### 技术优势
- ✅ **智能切换**: 自动选择最优处理模式
- ✅ **成本优化**: 减少 API 调用次数
- ✅ **稳定性高**: 分批处理更可靠
- ✅ **实时反馈**: 控制台显示处理进度
- ✅ **自动补全**: 缺失数据自动标记

#### Token 限制
- **max_tokens**: 16000
- **模型支持**: Gemini 2.5 Flash Lite
- **处理能力**:
  - 关键词优化: 无限制(自动分批)
  - 产品描述: 无限制(自动分批)

### 提示词工程

项目包含两套专业的提示词:

1. **关键词优化提示词** (`lib/prompts.ts:KEYWORD_PROMPT`)
   - 角色定位: 产品关键词优化助手
   - 核心能力: 提炼四字卖点 + 匹配表情符号
   - 特殊处理: 支持套餐格式(+连接符)

2. **描述生成提示词** (`lib/prompts.ts:DESCRIPTION_PROMPT`)
   - 角色定位: 菜品描述生成助手
   - 核心能力: 撰写吸引人的产品描述
   - 限制条件: 避免极限词,符合广告法

## 构建和部署

### 本地构建

```bash
npm run build
npm start
```

### 部署到 Vercel

1. 将项目推送到 GitHub
2. 在 Vercel 导入项目
3. 配置环境变量
4. 自动部署

### 使用 GitHub Actions 部署

项目支持通过 GitHub Actions 自动部署。配置文件将在下一步创建。

## 开发说明

### 添加新功能

1. 在 `components/` 目录创建新组件
2. 在 `lib/` 目录添加业务逻辑
3. 在 `types/` 目录定义类型
4. 更新主页面引入新功能

### 修改提示词

编辑 `lib/prompts.ts` 文件,调整提示词内容以优化输出效果。

### 自定义样式

项目使用 Tailwind CSS,可在组件中直接使用工具类,或在 `tailwind.config.ts` 中自定义主题。

## 常见问题

### Q: API 调用失败怎么办?

A: 请检查以下几点:
- 环境变量配置是否正确
- API Key 是否有效
- 网络连接是否正常
- API 服务商是否有使用限制

### Q: 导出的图片不清晰?

A: 系统使用原生 Canvas API 直接绘制表格,默认 `scale: 2` 已提供高清晰度。如需调整,可在 `utils/export.ts` 中修改 canvas 尺寸参数。

### Q: 图片导出失败怎么办?

A: 系统已采用原生 Canvas API 方案,完全避免了 CSS 颜色解析问题。如仍有问题,请检查浏览器控制台的错误信息。

### Q: 如何更换其他 AI 模型?

A: 修改 `.env.local` 中的 `NEXT_PUBLIC_API_MODEL` 和 `NEXT_PUBLIC_API_BASE_URL` 即可。

### Q: Excel 上传后找不到数据?

A: 请检查:
- 商品名称是否在第四列
- 第一行是否为表头
- 单元格是否为空
- 文件格式是否为 .xls 或 .xlsx

### Q: 大批量数据处理很慢?

A: 这是正常现象:
- 系统会自动分批处理
- 每批间隔 1 秒,避免 API 限流
- 100+ 条数据可能需要 5-10 秒
- 可在浏览器控制台(F12)查看实时进度

### Q: 部分数据生成失败?

A: 可能原因:
- Token 限制导致输出截断
- 系统已自动标记失败数据
- 可单独复制失败数据重新处理
- 建议分批处理更稳定

### Q: 侧边栏文案如何使用?

A: 两种复制方式:
- 点击右上角"复制"按钮
- 直接点击文案内容
- 复制后可粘贴到任意位置

## 版本更新

### v2.0 (2025-10-13)
- ✅ 新增 Excel 文件上传功能
- ✅ 新增智能分批处理
- ✅ 新增信息侧边栏
- ✅ Token 限制提升到 16000
- ✅ 支持无限量数据处理
- ✅ 优化错误处理和日志

### v1.0 (2025-10-12)
- ✅ 基础关键词优化功能
- ✅ 产品描述生成功能
- ✅ Excel 和图片导出
- ✅ 批量处理支持

## 许可证

MIT License

## 联系方式

如有问题或建议,欢迎提交 Issue 或 Pull Request。

